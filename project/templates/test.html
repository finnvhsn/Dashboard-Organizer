<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script>
        !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
    </script>

    <script>
        // Access weather data passed from Flask
        const weatherData = {{ weather_data | tojson | safe }};
    
        // Extract relevant weather information
        const weatherDescription = weatherData.weather[0].description;
        const temperature = weatherData.main.temp;
        const humidity = weatherData.main.humidity;
        const windSpeed = weatherData.wind.speed;
    
        // Update weather widget
        document.querySelector('.weatherwidget-io').setAttribute('data-label_1', weatherData.name);
        document.querySelector('.weatherwidget-io').setAttribute('data-weather', weatherDescription);
        document.querySelector('.weatherwidget-io').setAttribute('data-temperature', temperature + "°C");
        document.querySelector('.weatherwidget-io').setAttribute('data-humidity', "Humidity: " + humidity + "%");
        document.querySelector('.weatherwidget-io').setAttribute('data-wind', "Wind Speed: " + windSpeed + " m/s");

    </script>
        
        <style> 
        
            body 
            {
                margin: 0;
                padding: 0;
                font-family: Arial, sans-serif;
                background-color: #D6DBDF;
                overflow-x: hidden;
            }
    

        .grid-container
        {
            display: grid;
            grid-template-areas: 'header header header header header header '
                                 'left left left  right right right'
                                 'left-bottom left-bottom left-bottom  right-bottom right-bottom right-bottom';
            column-gap: 30px;
            row-gap: 30px; 
            background-color: #D6DBDF;
            height: 900px;
            margin: 0 auto;
        }


        .header
        { 
         display: flex;
         grid-area: header;
         justify-content: space-between;
         align-items: center;
         padding: 10px;
         background-color: #515F6C;
         color: #C1E9FF;
         height: 40px;
         position: sticky;
         top: 0;
         z-index: 1000;
         
        }

        
        .header_menu
        {
          display: flex; 
          gap: 20px;
          padding-right: 50px;
        }

        .header_title
        {
           font-size: 35px; 
           padding-left: 5px;
        }
        
       
        .container-painting
        {
            display: flex;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0.5, 0.3);
            grid-area: left; 
            margin-left: 10px;
            text-align: center;
            display: block;
        }

        .graph
        {  
            justify-content: center; 
            padding-left: 30px;
            size: 70%;
            padding-top: 45px; 
        }

        

        .stock_header
        {
            padding-left: 30px;
            
        }

        .container-weather
        {   
            grid-area: right; 
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0.5, 0.5);
            border-radius: 15px;
            margin-top: 0px;
            text-align: center;
            margin-right: 10px;

        }

        .widget {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            max-width: 300px;
            padding: 20px;
            text-align: center;
        }

        .weather-icon {
            width: 80px;
            height: 80px;
            filter: drop-shadow(6px 4px 20px rgba(0, 0, 0, 0.8));
        }

        .weather-info {
            font-size: 16px;
        }

        .temperature {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
         .city-name a {
            font-size: 30px;
            margin-bottom: 10px;
            text-decoration: none;
            color: inherit;
        }

        .space-news-container
        {
            grid-area: left-bottom;
            margin-left: 10px;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0.5, 0.5);
            border-radius: 15px;
            overflow-y: auto;
            margin-bottom: 10px;              
        }
        
        .space-news-container::-webkit-scrollbar
         {
            width: 10px;
         }
        
        .article-container
        {
         width: auto;
        }

        .news_header
        {
            text-align:center;
            background-color: #fff;
            height: 40px;
            padding-top: 3px;
        }
        
        .header_color
        {
            color: black;
            text-decoration: none;
        }
        
        .f1-results-table 
        {
            grid-area: right-bottom;
            overflow-y: auto; 
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0.5, 0.5);
            border-radius: 15px;
            margin-right: 10px;
            margin-bottom: 10px;
            
            font-family: Arial, sans-serif;

        }
        
        .f1_header
        {
          text-align: center;
          background-color: #fff;
          height: 40px;
          padding-top: 3px;
        }

        .f1-results-table::-webkit-scrollbar
         {
            width: 10px;
         }
        
        .f1-results-table table 
        {
            width: auto;
            border-collapse: collapse;
        }
        
        .f1-results-table th,
        .f1-results-table td 
        {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }
        
        .f1-results-table th 
        {
            background-color: #f2f2f2;
        }
        
        .f1-results-table tbody tr:nth-child(even)
        {
            background-color: #f2f2f2;
        }
        
        .f1-results-table tbody tr:hover 
        {
            background-color: #dddddd;
        }

        .painting-link{
            text-align: center;
        }

        
        .artwork 
        {
            max-width: 700px; /* Maximum width is 700px */
            max-height: 327px; /* Maximum height is 327px */
            display: block; /* Ensure the image is displayed as a block element */
            margin: auto;
        }
       

    </style>
        
</head>

<body>

  <div class="grid-container">

    <header class= "header">
        <div class="header_title"> Personal Dashboard</div>
        <div class="header_menu">
            <p>  <a style= "color: #C1E9FF; text-decoration: none;" href="notes">My Notes </a> </p>  
            <p>  <a style= "color: #C1E9FF; text-decoration: none;" href="/">Logout </a> </p>  
            <p>Settings</p>
        </div> 
    </header>

    <div class="container-painting">
        <a href="https://harvardartmuseums.org/collections/object/{{ painting_id }}?position={{ painting_id }}" target="_blank" id="painting-link">
            <img class= "artwork" src="{{ image }}" alt="Random Painting">
        </a> <!-- Close the <a> tag here -->
    </div>
    

      <div class="container-weather">
        <div class="weather" id="weather-widget">
            <div class="weather-info">
                <h2 class="city-name"><a href="#" target="_blank" id="city-link"></a></h2> <!-- City name link -->
                <img class="weather-icon" src="" alt="Weather Icon"> <!-- Weather icon will be displayed here -->
                <h2 class="temperature">--°C</h2>
                <p id="weather-info">Loading...</p>
            </div>
        </div>
        <script>
            // Update weather widget
            const weatherIconCode = weatherData.weather[0].icon; // Get the icon code from weather data
            const weatherIconUrl = `http://openweathermap.org/img/wn/${weatherIconCode}.png`; // Construct the URL for the weather icon
            document.querySelector('.weather-icon').setAttribute('src', weatherIconUrl); // Set the src attribute of the weather icon
            
            // Update city name link
            const cityNameLink = document.getElementById('city-link');
            cityNameLink.textContent = weatherData.name;
            cityNameLink.href = `https://openweathermap.org/city/${weatherData.id}`; // Set the href attribute of the city name link
            
            // Update temperature
            document.querySelector('.temperature').textContent = `${weatherData.main.temp}°C`;
    
    
            // Construct weather info HTML
            const weatherInfo = `
                <p><strong>Weather:</strong> ${weatherData.weather[0].description}</p>
                <p><strong>Humidity:</strong> ${weatherData.main.humidity}%</p>
                <p><strong>Wind Speed:</strong> ${weatherData.wind.speed} m/s</p>
            `;
            document.getElementById('weather-info').innerHTML = weatherInfo; // Set the inner HTML of weather info container
        </script>
    </div>
        
    

    <div class="space-news-container">
        <h2 class="news_header">Space News</h2>
        <table>
            <tbody>
                {% for article in articles %}
                <tr>
                    <td>
                        {% if article.image_url %}
                        <img src="{{ article.image_url }}" alt="Thumbnail" class="thumbnail" style="width: 200px;">
                        {% endif %}
                    </td>
                    <td>
                        <table>
                            <tr>
                                <td colspan="2">
                                    <h2><a class="header_color" href="{{ article.url }}">{{ article.title }}</a></h2>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p>{{ article.summary }}</p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    
    

    <div class="f1-results-table">
        <h2 class= "f1_header"> F1 Results </h2>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Race</th>
                    <th>Position</th>
                    <th>Driver</th>
                    <th>Constructor</th>
                </tr>
            </thead>
            <tbody>
                {% for race in f1_results %}
                {% for result in race['Results'] %}
                <tr>
                    {% if loop.first %}
                    <td rowspan="{{ loop.length }}">{{ race['Race'] }}</td>
                    {% endif %}
                    <td>{{ result['Position'] }}</td>
                    <td>{{ result['Driver'] }}</td>
                    <td>{{ result['Constructor'] }}</td>
                </tr>
                {% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    
  </div>


</body>
</html>